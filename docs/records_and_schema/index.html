<!DOCTYPE html><html><head><title>Parquet4s: Records & Schema</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Marcin Jakubowski" /><meta name="description" content="Read and write Parquet files using Scala" /><meta name="og:image" content="/parquet4s/img/poster.png" /><meta name="image" property="og:image" content="/parquet4s/img/poster.png" /><meta name="og:title" content="Parquet4s: Records & Schema" /><meta name="title" property="og:title" content="Parquet4s: Records & Schema" /><meta name="og:site_name" content="Parquet4s" /><meta name="og:url" content="" /><meta name="og:type" content="website" /><meta name="og:description" content="Read and write Parquet files using Scala" /><link rel="icon" type="image/png" href="/parquet4s/img/favicon.png" /><meta name="twitter:title" content="Parquet4s: Records & Schema" /><meta name="twitter:image" content="/parquet4s/img/poster.png" /><meta name="twitter:description" content="Read and write Parquet files using Scala" /><meta name="twitter:card" content="summary_large_image" /><link rel="icon" type="image/png" sizes="16x16" href="/parquet4s/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/parquet4s/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/parquet4s/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/parquet4s/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/parquet4s/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/parquet4s/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/parquet4s/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/parquet4s/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/parquet4s/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/parquet4s/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/parquet4s/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/parquet4s/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/parquet4s/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/parquet4s/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/parquet4s/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/parquet4s/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/parquet4s/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/parquet4s/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/parquet4s/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/parquet4s/img/favicon310x150.png" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/parquet4s/highlight/styles/vs.css" /><link rel="stylesheet" href="/parquet4s/css/light-style.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><div id="sidebar-brand"><a href="/parquet4s/" class="brand"><div class="brand-wrapper"></div><span>Parquet4s</span></a><button id="main-toggle" class="sidebar-toggle"><span class="close"></span></button></div><div class="sidebar-nav"> <div class="sidebar-nav-item  "><a href="/parquet4s/docs" title="Introduction" class="">Introduction</a></div> <div class="sidebar-nav-item  "><a href="/parquet4s/docs/quick_start" title="Quick Start" class="">Quick Start</a></div> <div class="sidebar-nav-item  "><a href="/parquet4s/docs/akka" title="Integration with Akka Streams" class="">Integration with Akka Streams</a></div> <div class="sidebar-nav-item  "><a href="/parquet4s/docs/fs2" title="Integration with FS2" class="">Integration with FS2</a></div> <div class="sidebar-nav-item  "><a href="/parquet4s/docs/storage_types" title="Supported Storage Types" class="">Supported Storage Types</a></div> <div class="sidebar-nav-item active "><a href="/parquet4s/docs/records_and_schema" title="Records and Schema" class="active">Records and Schema</a></div> <div class="sidebar-nav-item  "><a href="/parquet4s/docs/migration" title="Migration from 1.x" class="">Migration from 1.x</a></div></div></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li class="search-nav"><div id="search-dropdown"><label><i class="fa fa-search"></i>Search</label><input id="search-bar" type="text" placeholder="Enter keywords here..." onclick="displayToggleSearch(event)" /><ul id="search-dropdown-content" class="dropdown dropdown-content"></ul></div></li><li id="gh-eyes-item" class="hidden-xs to-uppercase"><a href="https://github.com/mjakubowski84/parquet4s" target="_blank" rel="noopener noreferrer"><i class="fa fa-eye"></i><span>Watchers<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs to-uppercase"><a href="https://github.com/mjakubowski84/parquet4s" target="_blank" rel="noopener noreferrer"><i class="fa fa-star-o"></i><span>Stars<span id="stars" class="label label-default">--</span></span></a></li></ul></div></div></div></div><div id="content" data-github-owner="mjakubowski84" data-github-repo="parquet4s"><div class="content-wrapper"><section><h1 id="records">Records</h1>

<p>A data entry in Parquet is called a <code class="language-plaintext highlighter-rouge">record</code>. Record can represent a <code class="language-plaintext highlighter-rouge">row</code> of data, or it can be a nested complex field in another <code class="language-plaintext highlighter-rouge">row</code>. Another types of record are a <code class="language-plaintext highlighter-rouge">map</code> and a <code class="language-plaintext highlighter-rouge">list</code>. Stored data must be organised in <code class="language-plaintext highlighter-rouge">row</code>s. Neither primitive type nor <code class="language-plaintext highlighter-rouge">map</code> or <code class="language-plaintext highlighter-rouge">list</code> are allowed as a root data type.
In Parquet4s those concepts are represented by types that extend <code class="language-plaintext highlighter-rouge">ParquetRecord</code>: <code class="language-plaintext highlighter-rouge">RowParquetRecord</code> and <code class="language-plaintext highlighter-rouge">MapParquetRecord</code>.<code class="language-plaintext highlighter-rouge">ParquetRecord</code> extends Scala’s immutable <code class="language-plaintext highlighter-rouge">Iterable</code> and allows iteration (next to many other operations) over its content: fields of a <code class="language-plaintext highlighter-rouge">row</code>, key-value entries of a <code class="language-plaintext highlighter-rouge">map</code> and elements of a <code class="language-plaintext highlighter-rouge">list</code>.</p>

<p>Parquet organizes row records into <code class="language-plaintext highlighter-rouge">pages</code> and pages into <code class="language-plaintext highlighter-rouge">row groups</code>. Row groups and pages are data blocks accompanied by metadata such as <code class="language-plaintext highlighter-rouge">statistics</code> and <code class="language-plaintext highlighter-rouge">dictionaries</code>. Metadata is leveraged during reading and filtering - so that some data blocks are skipped during reading if the metadata proves that the related data does not match provided filter predicate.</p>

<p>For more information about data structures in Parquet please refer to <a href="https://parquet.apache.org/documentation/latest/">official documentation</a>.</p>

<h1 id="schema">Schema</h1>

<p>Each Parquet file contains the schema of the data it stores. The schema defines structure of records, names and types of fields, optionality, etc. Schema is required for writing Parquet files and can be optionally used during reading (if you do not want to read all stored columns).</p>

<p>Official Parquet library, that Parquet4s is based on, defines the schema in Java type called <code class="language-plaintext highlighter-rouge">MessageType</code>. As it is quite tedious to define the schema and map it to your data types, Parquet4s comes with a handy mechanism that derives it automatically from Scala case classes. Please follow this documentation to learn which Scala types are supported out of the box and how to define custom encoders and decoders.</p>

<p>If you do not wish to map the schema of your data to Scala case classes then Parquet4s allows you to stick to generic records, that is, to aforementioned subtypes of <code class="language-plaintext highlighter-rouge">ParquetRecord</code>. Still, you must provide <code class="language-plaintext highlighter-rouge">MessageType</code> during writing. If you do not provide it during reading then Parquet4s uses the schema stored in a file and all its content is read.</p>

<h2 id="supported-types">Supported types</h2>

<h3 id="primitive-types">Primitive types</h3>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Type</th>
      <th style="text-align: center">Reading and Writing</th>
      <th style="text-align: center">Filtering</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">Int</td>
      <td style="text-align: center">☑</td>
      <td style="text-align: center">☑</td>
    </tr>
    <tr>
      <td style="text-align: left">Long</td>
      <td style="text-align: center">☑</td>
      <td style="text-align: center">☑</td>
    </tr>
    <tr>
      <td style="text-align: left">Byte</td>
      <td style="text-align: center">☑</td>
      <td style="text-align: center">☑</td>
    </tr>
    <tr>
      <td style="text-align: left">Short</td>
      <td style="text-align: center">☑</td>
      <td style="text-align: center">☑</td>
    </tr>
    <tr>
      <td style="text-align: left">Boolean</td>
      <td style="text-align: center">☑</td>
      <td style="text-align: center">☑</td>
    </tr>
    <tr>
      <td style="text-align: left">Char</td>
      <td style="text-align: center">☑</td>
      <td style="text-align: center">☑</td>
    </tr>
    <tr>
      <td style="text-align: left">Float</td>
      <td style="text-align: center">☑</td>
      <td style="text-align: center">☑</td>
    </tr>
    <tr>
      <td style="text-align: left">Double</td>
      <td style="text-align: center">☑</td>
      <td style="text-align: center">☑</td>
    </tr>
    <tr>
      <td style="text-align: left">BigDecimal</td>
      <td style="text-align: center">☑</td>
      <td style="text-align: center">☑</td>
    </tr>
    <tr>
      <td style="text-align: left">java.time.LocalDateTime</td>
      <td style="text-align: center">☑</td>
      <td style="text-align: center">☒</td>
    </tr>
    <tr>
      <td style="text-align: left">java.time.LocalDate</td>
      <td style="text-align: center">☑</td>
      <td style="text-align: center">☑</td>
    </tr>
    <tr>
      <td style="text-align: left">java.sql.Timestamp</td>
      <td style="text-align: center">☑</td>
      <td style="text-align: center">☒</td>
    </tr>
    <tr>
      <td style="text-align: left">java.sql.Date</td>
      <td style="text-align: center">☑</td>
      <td style="text-align: center">☑</td>
    </tr>
    <tr>
      <td style="text-align: left">Array[Byte]</td>
      <td style="text-align: center">☑</td>
      <td style="text-align: center">☑</td>
    </tr>
  </tbody>
</table>

<h3 id="complex-types">Complex Types</h3>

<p>Complex types can be arbitrarily nested.</p>

<ul>
  <li>Option</li>
  <li>List</li>
  <li>Seq</li>
  <li>Vector</li>
  <li>Set</li>
  <li>Array - Array of bytes is treated as primitive binary</li>
  <li>Map - <strong>Key must be of primitive type</strong>, only <strong>immutable</strong> version.</li>
  <li>Any Scala collection that has Scala collection <code class="language-plaintext highlighter-rouge">Factory</code> (in 2.12 it is derived from <code class="language-plaintext highlighter-rouge">CanBuildFrom</code>). Refers to both mutable and immutable collections. Collection must be bounded only by one type of element - because of that Map is supported only in immutable version.</li>
  <li><em>Any case class</em></li>
</ul>
</section></div></div></div></div><script src="/parquet4s/highlight/highlight.pack.js"></script><script src="/parquet4s/lunr/lunr.js"></script><script>
// For all code blocks, copy the language from the containing div
// to the inner code tag (where hljs expects it to be)
const langPrefix = 'language-';
document.querySelectorAll(`div[class^='${langPrefix}']`).forEach(function(div) {
  div.classList.forEach(function(cssClass) {
    if (cssClass.startsWith(langPrefix)) {
      const lang = cssClass.substring(langPrefix.length);
      div.querySelectorAll('pre code').forEach(function(code) {
        code.classList.add(lang);
      });
    }
  });
});

hljs.configure({languages:['scala','java','bash']});
hljs.initHighlightingOnLoad();
      </script><script>console.info('\x57\x65\x62\x73\x69\x74\x65\x20\x62\x75\x69\x6c\x74\x20\x77\x69\x74\x68\x3a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5f\x5f\x20\x20\x20\x20\x5f\x5f\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5f\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5f\x20\x5f\x5f\x0a\x20\x20\x20\x5f\x5f\x5f\x5f\x5f\x2f\x20\x2f\x5f\x20\x20\x2f\x20\x2f\x5f\x20\x20\x20\x20\x20\x20\x5f\x5f\x5f\x5f\x20\x5f\x5f\x5f\x20\x20\x28\x5f\x29\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x20\x20\x5f\x5f\x5f\x5f\x5f\x28\x5f\x29\x20\x2f\x5f\x5f\x5f\x5f\x20\x20\x5f\x5f\x5f\x5f\x5f\x0a\x20\x20\x2f\x20\x5f\x5f\x5f\x2f\x20\x5f\x5f\x20\x5c\x2f\x20\x5f\x5f\x2f\x5f\x5f\x5f\x5f\x5f\x2f\x20\x5f\x5f\x20\x60\x5f\x5f\x20\x5c\x2f\x20\x2f\x20\x5f\x5f\x5f\x2f\x20\x5f\x5f\x5f\x2f\x20\x5f\x5f\x20\x5c\x2f\x20\x5f\x5f\x5f\x2f\x20\x2f\x20\x5f\x5f\x2f\x20\x5f\x20\x5c\x2f\x20\x5f\x5f\x5f\x2f\x0a\x20\x28\x5f\x5f\x20\x20\x29\x20\x2f\x5f\x2f\x20\x2f\x20\x2f\x5f\x2f\x5f\x5f\x5f\x5f\x5f\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x5f\x5f\x2f\x20\x2f\x20\x20\x2f\x20\x2f\x5f\x2f\x20\x28\x5f\x5f\x20\x20\x29\x20\x2f\x20\x2f\x5f\x2f\x20\x20\x5f\x5f\x28\x5f\x5f\x20\x20\x29\x0a\x2f\x5f\x5f\x5f\x5f\x2f\x5f\x2e\x5f\x5f\x5f\x2f\x5c\x5f\x5f\x2f\x20\x20\x20\x20\x20\x2f\x5f\x2f\x20\x2f\x5f\x2f\x20\x2f\x5f\x2f\x5f\x2f\x5c\x5f\x5f\x5f\x2f\x5f\x2f\x20\x20\x20\x5c\x5f\x5f\x5f\x5f\x2f\x5f\x5f\x5f\x5f\x2f\x5f\x2f\x5c\x5f\x5f\x2f\x5c\x5f\x5f\x5f\x2f\x5f\x5f\x5f\x5f\x2f\x0a\x0a\x68\x74\x74\x70\x73\x3a\x2f\x2f\x34\x37\x64\x65\x67\x2e\x67\x69\x74\x68\x75\x62\x2e\x69\x6f\x2f\x73\x62\x74\x2d\x6d\x69\x63\x72\x6f\x73\x69\x74\x65\x73')</script><script src="/parquet4s/js/search.js"></script><script src="/parquet4s/js/docs.js"></script></body></html>